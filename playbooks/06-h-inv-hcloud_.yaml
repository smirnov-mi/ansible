# trying to create dynamic hcloud inventory
---

- name: Gather hcloud location infos
  plugin: hetzner.hcloud.hcloud
  token: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          64346565623132326232343365386433373335646237653931616333313134336636366431323464
          3865353236636162383534326233363965626536323464640a653138653565653932326637633932
          62326335653138646563346131383861643037636261626239356564363336646363656338663262
          6634613035346362310a336463653666303736353565663565646139623037646539356164373936
          30333031303961316438313633303763373737343437626530643838643662306431636564376266
          62626538356335623061353035323766616466623839623130336365653436326364623538353633
          39666339306332313833396630313266363631386136313931666533323563393632333132653662
          38633738656261636561
  keyed_groups:
    - key: labels

  plugin: hcloud
  hosts: localhost
  connection: local
  gather_facts: false
  vars_files:
    - ~/vars/hcloud_token.yml

  tasks:
  - name: gather info from hcloud 
    hcloud_location_info:
    register: output

  - name: Print the gathered infos
    debug:
      var: output
